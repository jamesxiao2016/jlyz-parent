<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.dlbdata.dj.db.mapper.DjDeptMapper">
  <resultMap id="BaseResultMap" type="cn.dlbdata.dj.db.pojo.DjDept">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="dj_section_id" jdbcType="BIGINT" property="djSectionId" />
    <result column="dj_building_id" jdbcType="BIGINT" property="djBuildingId" />
    <result column="floor" jdbcType="VARCHAR" property="floor" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="people_num" jdbcType="INTEGER" property="peopleNum" />
    <result column="address" jdbcType="INTEGER" property="address" />
    <result column="phone" jdbcType="VARCHAR" property="phone" />
    <result column="status" jdbcType="INTEGER" property="status" />
    <result column="parent_id" jdbcType="BIGINT" property="parentId" />
    <result column="dept_level" jdbcType="VARCHAR" property="deptLevel" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="principal_id" jdbcType="BIGINT" property="principalId" />
    <result column="principal_name" jdbcType="VARCHAR" property="principalName" />
  </resultMap>


  <select id="getBranchDeptInfoBySectionId" parameterType="java.lang.Long"
       resultType="cn.dlbdata.dj.db.vo.party.BranchDeptInfoVo">
    SELECT dept.name as deptName , id as deptId,(SELECT count(0) from dj_partymember where dept_id = dept.id) as total,
    dept.principal_name as leaderName
    from dj_dept dept
    where dept.dj_section_id = #{sectionId}
  </select>

  <select id="getBranchDeptIdAndName" parameterType="java.lang.Long" resultType="cn.dlbdata.dj.db.vo.dept.DeptIdNameDto">
    select id as deptId,name as deptName  from dj_dept where dj_section_id= #{sectionId}
  </select>
</mapper>